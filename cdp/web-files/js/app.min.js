"use strict";var app=angular.module("appSite",["ngRoute","Controller","Services","Directives","Filter","ngSanitize","angular-loading-bar","ngAnimate","ngCookies","duScroll"]);app.config(["$routeProvider","cfpLoadingBarProvider",function(e,t){t.includeSpinner=!1,e.when("/home",{templateUrl:"partials/home/index.html"}).when("/enviarpush",{templateUrl:"partials/push/enviar.html"}).when("/clientes",{templateUrl:"partials/clientes/index.html"}).when("/clientes/adicionar",{templateUrl:"partials/clientes/adicionar.html"}).when("/clientes/editar/:id",{templateUrl:"partials/clientes/editar.html"}).when("/auditoria",{templateUrl:"partials/auditoria/index.html"}).when("/usuarios",{templateUrl:"partials/usuarios/index.html"}).when("/usuarios/adicionar",{templateUrl:"partials/usuarios/adicionar.html"}).when("/usuarios/editar/:id",{templateUrl:"partials/usuarios/editar.html"}).otherwise({redirectTo:"/home"})}]);var ctrl=angular.module("Controller",["Services"]);ctrl.controller("PrincipalCtrl",["Usuarios","Auditoria","$http",function(e,t){var n=this;n.controle={},n.dadosLogado={},e.infologado().then(function(r){1==r.data[0].nivel?(n.controle.tipo="adm",n.controle.username=r.data[0].username,n.controle.nome=r.data[0].nome):2==r.data[0].nivel?(n.controle.tipo="usuario",n.controle.username=r.data[0].username,n.controle.nome=r.data[0].nome):n.controle.tipo="usuario",n.dadosLogado.nomecompleto=r.data[0].nome,n.dadosLogado.foto=r.data[0].foto,t.setUsuario(n.controle.nome),e.setUsulogado(r.data[0].token)},function(){alert(" Ops! Ocorreu um Erro! "),n.controle="usuario"})}]),ctrl.controller("PushAddCtrl",["Push","Usuarios","Clientes","$document",function(e,t,n,r){function i(){r.scrollTop(0,500)}var o=this;n.getSpec(t.getUsulogado()).then(function(e){o.clientes=e.data}),o.salvar=function(t){e.enviar(t).then(function(){o.notificacao="",i(),o.msgSuccess=!0,o.msgError=!1},function(){o.msgError=!0,o.msgSuccess=!1})}}]),ctrl.controller("AuditoriaCtrl",["Auditoria",function(e){var t=this;e.get().then(function(e){t.usuLista=e.data},function(){})}]),ctrl.controller("ClientesCtrl",["Clientes","Usuarios","$document","$filter",function(e,t,n){function r(){e.getSpec(t.getUsulogado()).then(function(e){o.cliLista=e.data})}function i(){n.scrollTop(0,500)}var o=this;o.selectedDonos=[],t.get().then(function(e){o.usuarios=e.data,r()}),o.toggleSelection=function(e){var t=o.selectedDonos.indexOf(e);t>-1?o.selectedDonos.splice(t,1):o.selectedDonos.push(e)},o.deletar=function(t){e.deletar(t).then(function(){o.cliLista.splice(o.cliLista.indexOf(t),1),o.msgSuccess=!0,o.msgError=!1},function(){o.msgError=!0,o.msgSuccess=!1})},o.salvar=function(t){t.dono_token="{"+(""+o.selectedDonos)+"}",e.insere(t).then(function(){o.clientes="",i(),o.msgSuccess=!0,o.msgError=!1},function(){o.msgError=!0,o.msgSuccess=!1})}}]),ctrl.controller("ClientesEditCtrl",["$routeParams","Clientes","Usuarios","$document",function(e,t,n,r){function i(){t.getEdit(e.id).then(function(e){s.cliEdit=e.data[0],s.tokens=o(e.data[0].dono_token).split(",")})}function o(e){return e.slice(1,-1)}function a(){r.scrollTop(0,500)}var s=this;s.tokens=[],n.get().then(function(e){s.usuarios=e.data,i()}),s.toggleSelection=function(e){var t=s.tokens.indexOf(e);t>-1?s.tokens.splice(t,1):s.tokens.push(e)},s.alterar=function(e){e.dono_token="{"+(""+s.tokens)+"}",t.update(e).then(function(e){a(),s.cliEdit=e.data,s.cliEdit.dono_token=o(s.cliEdit.dono_token),s.msgSuccess=!0,s.msgError=!1},function(){s.msgError=!0,s.msgSuccess=!1})}}]),ctrl.controller("UsuariosCtrl",["Usuarios","$document","$filter",function(e,t){function n(){t.scrollTop(0,500)}var r=this;e.get().then(function(e){r.usuLista=e.data}),r.deletar=function(t){e.deletar(t).then(function(){r.usuLista.splice(r.usuLista.indexOf(t),1),r.msgSuccess=!0,r.msgError=!1},function(){r.msgError=!0,r.msgSuccess=!1})},r.salvar=function(t){t.username=t.email,e.insere(t).then(function(){r.usuarios="",n(),r.msgSuccess=!0,r.msgError=!1},function(){r.msgError=!0,r.msgSuccess=!1})}}]),ctrl.controller("UsuariosEditCtrl",["$routeParams","Usuarios","$document",function(e,t,n){var r=this;t.getEdit(e.id).then(function(e){r.usuEdit=e.data[0]}),r.alterar=function(e){e.username=e.email,t.update(e).then(function(e){r.usuEdit=e.data,r.msgSuccess=!0,r.msgError=!1},function(){r.msgError=!0,r.msgSuccess=!1})}}]);var dir=angular.module("Directives",["Controller","Services"]);dir.directive("fordata",[function(){return{restrict:"EA",replace:!0,link:function(e,t,n){var r=n.data,i=r.split("-");e.setData=i[2]+"/"+i[1]+"/"+i[0]}}}]),dir.directive("menu",[function(){return{restrict:"E",scope:{permissoes:"="},templateUrl:"directives/menu.html"}}]),dir.directive("loadingPage",["$http",function(){return{restrict:"A",scope:"true",link:function(e,t){e.$on("$routeChangeStart",function(){t.removeClass("loading-hide")}),e.$on("$routeChangeSuccess",function(){t.addClass("loading-hide")})}}}]);var fil=angular.module("Filter",[]);fil.filter("filBoolean",[function(){return function(e){return e?"Sim":"Não"}}]),fil.filter("toTrusted",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),fil.filter("lowerCaseNoSpace",[function(){return function(e){if(void 0!=e){for(var t=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g],n=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"],r=0;t.length>r;r++)e=e.replace(t[r],n[r]);return e=e.replace(/\s/g,""),e.toLowerCase()}}}]),angular.module("ui.tinymce",[]).value("uiTinymceConfig",{}).directive("uiTinymce",["uiTinymceConfig",function(e){e=e||{};var t=0;return{priority:10,require:"ngModel",link:function(n,r,i,o){function a(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,r=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(r,"").replace(n,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})}var s,u,c,l=function(){o.$setViewValue(r.val()),n.$root.$$phase||n.$apply()};if(i.id||i.$set("id","uiTinymce"+t++),s=i.uiTinymce?n.$eval(i.uiTinymce):{},s.setup){var f=s.setup;delete s.setup}u={setup:function(e){e.on("init",function(){o.$render(),o.$setPristine()}),e.on("ExecCommand",function(){e.save(),l()}),e.on("KeyUp",function(){e.save(),l()}),e.on("SetContent",function(t){t.initial||o.$viewValue===t.content||(e.save(),l())}),e.on("blur",function(){r.blur()}),e.on("ObjectResized",function(){e.save(),l()}),f&&f(e)},mode:"exact",menubar:!1,statusbar:!1,plugins:"advlist autolink link image lists charmap print preview jbimages paste code youtube",toolbar:"bold | italic | removeformat | link | code ",forced_root_block:"p",paste_preprocess:function(e,t){t.content=a(t.content,"")},paste_postprocess:function(){},elements:i.id},angular.extend(u,e,s),setTimeout(function(){tinymce.init(u)}),o.$render=function(){c||(c=tinymce.get(i.id)),c&&c.setContent(o.$viewValue||"")},n.$on("$destroy",function(){c||(c=tinymce.get(i.id)),c&&(c.remove(),c=null)})}}}]);var service=angular.module("Services",[]);service.factory("Usuarios",["$http","$cookies","Auditoria",function(e,t,n){return{get:function(){return e.get("service/usuarios").success(function(){}).error(function(){})},getEdit:function(t){return e.get("service/usuarios/getedit/"+t).success(function(e){n.insere("Entrou para Editar a Usuário: "+e[0].nome)}).error(function(){})},getSpec:function(t){return e.get("service/usuarios/getspec/"+t).success(function(){}).error(function(){})},getNotSpec:function(t){return e.get("service/usuarios/getnotspec/"+t).success(function(){}).error(function(){})},insere:function(t){return e.post("service/usuarios/inserir",t).success(function(e){n.insere("Entrou para inserir um usuário: "+e.nome)}).error(function(){})},update:function(t){return e.post("service/usuarios/atualizar",t).success(function(e){n.insere("Entrou para atualizar um Usuário: "+e.nome)}).error(function(){})},deletar:function(t){return e.post("service/usuarios/delete",t).success(function(){n.insere("Entrou para deletar um Usuário: "+t.nome)}).error(function(){})},deleteFoto:function(t){return e.post("service/usuarios/deletefotousuario",t).success(function(){n.insere("Entrou para deletar uma Foto")}).error(function(){})},infologado:function(){return e.get("service/usuarios/infologado").success(function(){}).error(function(){})},setUsulogado:function(e){t.put("tokenDono",e)},getUsulogado:function(){return t.get("tokenDono")}}}]),service.factory("Push",["$http","Auditoria",function(e,t){return{enviar:function(n){return e.post("service/push/enviar",n).success(function(e){t.insere("Enviou um push: "+e.msg)}).error(function(){})}}}]),service.factory("Timeline",["$http","Auditoria",function(e){return{get:function(){return e.get("service/timeline").success(function(){}).error(function(){})},getEdit:function(t){return e.get("service/timeline/getedit/"+t).success(function(){}).error(function(){})},getSpec:function(t){return e.get("service/timeline/getspec/"+t).success(function(){}).error(function(){})},getPerfil:function(t){return e.get("service/timeline/getperfil/"+t).success(function(){}).error(function(){})}}}]),service.factory("Auditoria",["$http",function(e){var t=null;return{get:function(){return e.get("service/auditoria").success(function(){}).error(function(){})},setUsuario:function(e){t=e},insere:function(n){if(!n.usuario){var r={};r.usuario=t,r.conteudo=n,n=r}return e.post("service/auditoria/inserir",n).success(function(){}).error(function(){})}}}]),service.factory("Clientes",["$http","Auditoria",function(e,t){return{getEdit:function(n){return e.get("service/clientes/getedit/"+n).success(function(e){t.insere("Entrou para Editar um Cliente: "+e[0].nome)}).error(function(){})},getSpec:function(t){return e.get("service/clientes/getspec/"+t).success(function(){}).error(function(){})},insere:function(n){return e.post("service/clientes/inserir",n).success(function(e){t.insere("Entrou para inserir um cliente: "+e.nome)}).error(function(){})},update:function(n){return e.post("service/clientes/atualizar",n).success(function(e){t.insere("Entrou para atualizar um cliente: "+e.nome)}).error(function(){})},deletar:function(n){return e.post("service/clientes/delete",n).success(function(){t.insere("Entrou para deletar um cliente: "+n.nome)}).error(function(){})}}}]);